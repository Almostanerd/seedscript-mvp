<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SeedScript | Phygital Impact Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        seed: { cream: '#FDFBF7', sage: '#C3D0C1', deep: '#4A5D4E', accent: '#D4A373' }
                    },
                    fontFamily: { sans: ['Outfit', 'sans-serif'], serif: ['Playfair Display', 'serif'] },
                    animation: {
                        'enter': 'fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards',
                        'float-slow': 'float 15s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(30px) scale(0.98)' }, '100%': { opacity: '1', transform: 'translateY(0) scale(1)' } },
                        float: { '0%, 100%': { transform: 'translate(0, 0) rotate(0deg)' }, '50%': { transform: 'translate(30px, -20px) rotate(8deg)' } }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #FDFBF7; color: #4A5D4E; overflow-x: hidden; }
        .glass-panel { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.9); box-shadow: 0 20px 40px -10px rgba(74, 93, 78, 0.1); }
        .loading-spinner { border: 3px solid rgba(74, 93, 78, 0.1); border-left-color: #4A5D4E; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        select {-webkit-appearance: none; appearance: none;}
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center py-10 px-4 relative antialiased" onload="initLocation()">

    <div class="fixed inset-0 pointer-events-none -z-10 overflow-hidden">
        <div class="absolute top-0 left-0 -translate-x-1/4 -translate-y-1/4 w-96 h-96 bg-seed-sage/30 rounded-full blur-3xl animate-float-slow"></div>
        <div class="absolute bottom-0 right-0 translate-x-1/4 translate-y-1/4 w-[35rem] h-[35rem] bg-seed-accent/15 rounded-full blur-3xl animate-float-slow" style="animation-delay: -5s;"></div>
    </div>

    <main class="w-full max-w-md relative z-10 opacity-0 animate-enter">
        <header class="text-center mb-6">
            <div class="inline-flex p-4 rounded-full bg-white/80 mb-4 shadow-sm ring-1 ring-seed-sage/20">
               <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#4A5D4E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22v-5"/><path d="M9 12.22c.82-.7 2.3-1.66 3-2.22 0 0 2.29 1.75 3.8 3.44 1.3 1.45 2.2 3.86 1.48 5.35C16.4 20.5 14 22 12 22s-4.4-1.5-5.28-3.21c-.72-1.49.18-3.9 1.48-5.35z"/><path d="M12 10c.38-.6 1.27-1.92 2-3.41 1.22-2.5 1.46-4.89.73-5.87-.81-1.1-3.28-.44-5.46 1.75C8.07 3.53 7.5 4.8 7.5 6c0 2.06.79 4.19 2 6"/></svg>
            </div>
            <h1 class="font-serif text-5xl italic font-medium mb-2 text-seed-deep tracking-tight">SeedScript</h1>
            <p class="text-[0.65rem] font-bold tracking-[0.3em] uppercase text-seed-deep/60">Sustainability Boutique</p>
        </header>

        <div class="glass-panel rounded-[2rem] p-8 sm:p-10 transition-all duration-500 relative overflow-hidden">
            
            <div id="input-section">
                <label class="block text-sm font-medium mb-3 ml-1 tracking-wide uppercase text-xs opacity-70">Select Pencil Variety</label>
                <div class="relative mb-8 group">
                    <select id="seedSelect" class="w-full p-5 pr-12 rounded-2xl bg-white/90 border-2 border-transparent text-seed-deep font-serif text-xl focus:border-seed-sage/50 outline-none cursor-pointer shadow-sm font-sans">
                        <option value="marigold">üåº Mellow Marigold</option>
                        <option value="carrot">ü•ï Candid Carrot</option>
                        <option value="beans">ü´ò Bountiful Beans</option>
                        <option value="fenugreek">üçÉ Feisty Fenugreek</option>
                        <option value="coriander">üåø Clever Coriander</option>
                    </select>
                </div>

                <div class="flex items-center gap-4 mb-10 p-5 bg-seed-sage/15 rounded-2xl border border-seed-sage/10">
                    <div class="p-2.5 bg-white rounded-full shadow-sm">üìç</div>
                    <div class="text-sm leading-tight">
                        <p class="font-bold opacity-80 mb-0.5">Garden Climate</p>
                        <p id="location-name-ui" class="opacity-60 font-medium italic">Detecting garden...</p>
                    </div>
                </div>

                <button onclick="calculateImpact()" class="w-full py-5 rounded-full bg-seed-deep text-seed-cream font-bold text-lg shadow-lg active:scale-[0.98] transition-all">
                    Analyze My Garden
                </button>
            </div>

            <div id="loading-section" class="hidden text-center py-16 animate-enter">
                <div class="loading-spinner mx-auto mb-6"></div>
                <h3 class="font-serif text-xl mb-2">Consulting the Earth...</h3>
                <p class="text-sm font-medium opacity-60">Syncing with atmospheric sensors.</p>
            </div>

            <div id="results-section" class="hidden animate-enter">
                <div class="flex justify-between items-start mb-8 border-b border-seed-deep/10 pb-6">
                    <div>
                        <h2 class="font-serif text-3xl italic mb-1">Impact Forecast</h2>
                        <p id="seed-name-display" class="text-xs uppercase font-bold opacity-50">Variety</p>
                    </div>
                    <button onclick="resetApp()" class="px-4 py-2 rounded-full text-[10px] font-bold bg-seed-sage/20 uppercase opacity-70">Back</button>
                </div>

                <div class="grid grid-cols-2 gap-5 mb-6">
                    <div class="bg-white/60 p-5 rounded-[1.5rem] text-center shadow-sm">
                        <p class="text-[0.65rem] uppercase font-bold opacity-40 mb-1">Survival Odds</p>
                        <p id="success-val" class="text-4xl font-serif font-bold text-seed-deep">-</p>
                    </div>
                    <div class="bg-white/60 p-5 rounded-[1.5rem] text-center shadow-sm">
                        <p class="text-[0.65rem] uppercase font-bold opacity-40 mb-1">CO‚ÇÇ Captured</p>
                        <p id="co2-val" class="text-4xl font-serif font-bold text-seed-deep">-</p>
                    </div>
                </div>

                <div id="mismatch-box" class="p-5 bg-seed-sage/10 rounded-3xl mb-6 space-y-3">
                    <div class="flex justify-between text-xs font-bold uppercase opacity-60 tracking-wider">
                        <span>Nature Scan</span>
                        <span>Reading</span>
                    </div>
                    <div class="flex justify-between text-sm font-medium border-t border-seed-deep/5 pt-2">
                        <span>üå°Ô∏è Temperature</span>
                        <span id="temp-display">--</span>
                    </div>
                    <div class="flex justify-between text-sm font-medium">
                        <span>üíß Humidity</span>
                        <span id="hum-display">--</span>
                    </div>
                    <p id="data-deep-dive" class="text-[10px] font-medium leading-relaxed italic opacity-80 pt-2 border-t border-seed-deep/5"></p>
                </div>

                <div class="bg-seed-deep text-seed-cream p-6 rounded-[1.5rem] shadow-lg">
                    <p class="text-[0.65rem] font-bold uppercase opacity-60 mb-3 tracking-widest">Secret Growth Strategy</p>
                    <p id="suggestion-text" class="text-lg font-serif leading-relaxed italic opacity-95">"Thinking..."</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        const API_KEY = 'a762377e064d6c67247dd4b7e9e5c21c'; 
        let globalWeatherData = null;
        let detectedCity = "Manipal";

        const seedKnowledge = {
            marigold: { name: "Mellow Marigold", opt: [18, 30, 50], co2: 120,
                quirks: {
                    cold: "CITY_NAME is giving frost-bitten vibes! Marigolds are sun-seekers. Keep your pencil-pot on a sunny windowsill until the morning air warms up.",
                    hot: "Goldilocks Alert! CITY_NAME is a bit too toasty. Give these golden guardians a long drink at dawn and some afternoon shade to keep them mellow.",
                    humid: "Lush Living! Humidity in CITY_NAME is high. These Marigolds love it, but make sure they have a 'breezy' spot to keep their petals perfect."
                }
            },
            carrot: { name: "Candid Carrot", opt: [12, 22, 45], co2: 95,
                quirks: {
                    cold: "Cooler than a cucumber! Carrots actually love the CITY_NAME chill. It makes their roots sweeter. This is peak planting time for a crunch.",
                    hot: "Too Hot to Trot! The CITY_NAME heat might make your carrots 'bolt' or get woody. Keep the pot in the coolest, shadiest corner of your room.",
                    humid: "Damp Ground Danger! Carrots hate 'soggy bottoms.' If CITY_NAME is humid, ensure your pot has incredible drainage so the roots don't rot."
                }
            },
            beans: { name: "Bountiful Beans", opt: [20, 28, 60], co2: 160,
                quirks: {
                    cold: "Hibernation Mode! Beans are tropical at heart and hate the CITY_NAME cold. Start them strictly indoors near a heater or a warm computer vent.",
                    hot: "Summer Stretch! Beans love this CITY_NAME warmth. They'll grow fast, so get a trellis (or a tall chopstick) ready for them to climb toward the sun.",
                    humid: "Jungle Fever! Bountiful Beans thrive in CITY_NAME's moisture. It helps their leaves stay lush. Just watch out for any fuzzy spots on the leaves."
                }
            },
            fenugreek: { name: "Feisty Fenugreek", opt: [10, 25, 40], co2: 75,
                quirks: {
                    cold: "Frost Fighter! Fenugreek is a winter warrior. It'll survive the CITY_NAME chill better than most. Plant outside and enjoy the rapid green growth.",
                    hot: "Wilting Warning! CITY_NAME is looking a bit scorched. Fenugreek prefers a cool breeze. Keep it indoors under a fan if the sun gets too aggressive.",
                    humid: "Quick & Crunchy! High humidity in CITY_NAME means microgreen magic. You can harvest these feisty leaves in just 2 weeks if you keep the air moving."
                }
            },
            coriander: { name: "Clever Coriander", opt: [15, 25, 45], co2: 85,
                quirks: {
                    cold: "Crisp & Clever! Coriander thinks CITY_NAME is perfect right now. This cool air prevents it from flowering too early, giving you more leaves for your tacos.",
                    hot: "Bolt Alert! It's too hot in CITY_NAME. Your coriander might try to turn into a flower immediately. Keep it in the fridge-door-cool parts of your home.",
                    humid: "Aromatic Air! The moisture in CITY_NAME helps the essential oils develop. Your room will smell amazing, but mist the air instead of soaking soil!"
                }
            }
        };

        async function initLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async (pos) => {
                    const { latitude, longitude } = pos.coords;
                    const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&units=metric&appid=${API_KEY}`);
                    globalWeatherData = await res.json();
                    detectedCity = globalWeatherData.name;
                    document.getElementById('location-name-ui').innerText = `${detectedCity}, ${globalWeatherData.sys.country}`;
                }, () => {
                    document.getElementById('location-name-ui').innerText = "Manipal, Karnataka (IN)";
                });
            }
        }

        async function calculateImpact() {
            document.getElementById('input-section').classList.add('hidden');
            document.getElementById('loading-section').classList.remove('hidden');

            const seed = seedKnowledge[document.getElementById('seedSelect').value];
            document.getElementById('seed-name-display').innerText = seed.name;

            if (!globalWeatherData) {
                const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=Manipal,IN&units=metric&appid=${API_KEY}`);
                globalWeatherData = await res.json();
            }

            processFinalLogic(globalWeatherData, seed);
        }

        function processFinalLogic(data, seed) {
            const temp = data.main.temp;
            const hum = data.main.humidity;
            let prob = 94; 
            let suggestion = "";
            let deepDive = `Environmental Sync: `;

            if (temp < seed.opt[0]) {
                const delta = (seed.opt[0] - temp).toFixed(1);
                prob -= (delta * 0.8);
                suggestion = seed.quirks.cold.replace(/CITY_NAME/g, detectedCity);
                deepDive += `It's crisp out! An indoor start is your secret weapon. `;
            } else if (temp > seed.opt[1]) {
                const delta = (temp - seed.opt[1]).toFixed(1);
                prob -= (delta * 1.0);
                suggestion = seed.quirks.hot.replace(/CITY_NAME/g, detectedCity);
                deepDive += `Sun alert! Shady spots or indoor shelves work best today. `;
            } else {
                suggestion = `Perfect conditions in ${detectedCity}! Your ${seed.name} is ready for an outdoor adventure.`;
                deepDive += `Climate is in the Goldilocks zone. `;
            }

            if (Math.abs(hum - seed.opt[2]) > 20 && hum > 80) {
                suggestion = seed.quirks.humid.replace(/CITY_NAME/g, detectedCity);
            }

            prob = Math.min(Math.max(prob, 72), 99);
            const co2 = (seed.co2 * (prob / 100) * 1.8).toFixed(0);

            setTimeout(() => {
                document.getElementById('loading-section').classList.add('hidden');
                document.getElementById('results-section').classList.remove('hidden');
                document.getElementById('temp-display').innerText = `${Math.round(temp)}¬∞C`;
                document.getElementById('hum-display').innerText = `${hum}%`;
                document.getElementById('data-deep-dive').innerText = deepDive;
                document.getElementById('suggestion-text').innerText = `"${suggestion}"`;
                animateValue("success-val", 0, Math.round(prob), 1200, "%");
                animateValue("co2-val", 0, co2, 1500, "g");
            }, 1200);
        }

        function animateValue(id, start, end, duration, suffix) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                obj.innerHTML = Math.floor(easeOutQuart * (end - start) + start) + suffix;
                if (progress < 1) window.requestAnimationFrame(step);
                else obj.innerHTML = end + suffix;
            };
            window.requestAnimationFrame(step);
        }

        function resetApp() {
            document.getElementById('results-section').classList.add('hidden');
            document.getElementById('input-section').classList.remove('hidden');
        }
    </script>
</body>
</html>
