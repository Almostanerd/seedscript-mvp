<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SeedScript | Phygital Impact Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        seed: { cream: '#FDFBF7', sage: '#C3D0C1', deep: '#4A5D4E', accent: '#D4A373' }
                    },
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    animation: {
                        'enter': 'fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards',
                        'float-slow': 'float 15s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(30px) scale(0.98)' },
                            '100%': { opacity: '1', transform: 'translateY(0) scale(1)' },
                        },
                        float: {
                            '0%, 100%': { transform: 'translate(0, 0) rotate(0deg)' },
                            '50%': { transform: 'translate(30px, -20px) rotate(8deg)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #FDFBF7; color: #4A5D4E; overflow-x: hidden; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.9);
            box-shadow: 0 20px 40px -10px rgba(74, 93, 78, 0.1);
        }
        .loading-spinner {
            border: 3px solid rgba(74, 93, 78, 0.1);
            border-left-color: #4A5D4E;
            border-radius: 50%;
            width: 30px; height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        select {-webkit-appearance: none; appearance: none;}
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center py-10 px-4 relative antialiased">

    <div class="fixed inset-0 pointer-events-none -z-10 overflow-hidden">
        <div class="absolute top-0 left-0 -translate-x-1/4 -translate-y-1/4 w-96 h-96 bg-seed-sage/30 rounded-full blur-3xl animate-float-slow"></div>
        <div class="absolute bottom-0 right-0 translate-x-1/4 translate-y-1/4 w-[35rem] h-[35rem] bg-seed-accent/15 rounded-full blur-3xl animate-float-slow" style="animation-delay: -5s;"></div>
    </div>

    <main class="w-full max-w-md relative z-10 opacity-0 animate-enter">
        
        <header class="text-center mb-6">
            <div class="inline-flex p-4 rounded-full bg-white/80 mb-4 shadow-sm ring-1 ring-seed-sage/20">
               <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#4A5D4E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22v-5"/><path d="M9 12.22c.82-.7 2.3-1.66 3-2.22 0 0 2.29 1.75 3.8 3.44 1.3 1.45 2.2 3.86 1.48 5.35C16.4 20.5 14 22 12 22s-4.4-1.5-5.28-3.21c-.72-1.49.18-3.9 1.48-5.35z"/><path d="M12 10c.38-.6 1.27-1.92 2-3.41 1.22-2.5 1.46-4.89.73-5.87-.81-1.1-3.28-.44-5.46 1.75C8.07 3.53 7.5 4.8 7.5 6c0 2.06.79 4.19 2 6"/></svg>
            </div>
            <h1 class="font-serif text-5xl italic font-medium mb-2 text-seed-deep tracking-tight">SeedScript</h1>
            <p class="text-[0.65rem] font-bold tracking-[0.3em] uppercase text-seed-deep/60">Phygital Sustainability Lab</p>
        </header>

        <div class="glass-panel rounded-[2rem] p-8 sm:p-10 transition-all duration-500 relative overflow-hidden">
            
            <div id="input-section">
                <label class="block text-sm font-medium mb-3 ml-1 tracking-wide uppercase text-xs opacity-70">Select Your Pencil Type</label>
                
                <div class="relative mb-8 group">
                    <select id="seedSelect" class="w-full p-5 pr-12 rounded-2xl bg-white/90 border-2 border-transparent text-seed-deep font-serif text-xl focus:border-seed-sage/50 focus:ring-0 focus:bg-white outline-none cursor-pointer transition-all shadow-sm group-hover:shadow-md">
                        <option value="tomato">üçÖ Heirloom Tomato</option>
                        <option value="chilli">üå∂Ô∏è Hot Chilli</option>
                        <option value="marigold">üåº French Marigold</option>
                        <option value="coriander">üåø Coriander (Dhania)</option>
                        <option value="basil">üçÉ Genovese Basil</option>
                        <option value="spinach">ü•¨ Spinach (Palak)</option>
                    </select>
                    <div class="absolute right-5 top-1/2 -translate-y-1/2 pointer-events-none text-seed-deep/40 transition-transform group-hover:translate-y-[-45%]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m6 9 6 6 6-6"/></svg>
                    </div>
                </div>

                <div class="flex items-center gap-4 mb-10 p-5 bg-seed-sage/15 rounded-2xl border border-seed-sage/10">
                    <div class="p-2.5 bg-white rounded-full shadow-sm text-seed-deep">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>
                    </div>
                    <div class="text-sm leading-tight">
                        <p class="font-bold opacity-80 mb-0.5">Location Detected</p>
                        <p class="opacity-60 font-medium">Manipal, Karnataka (IN)</p>
                    </div>
                </div>

                <button onclick="calculateImpact()" class="w-full py-5 rounded-full bg-seed-deep text-seed-cream font-bold text-lg shadow-[0_10px_30px_-10px_rgba(74,93,78,0.4)] hover:shadow-[0_15px_35px_-10px_rgba(74,93,78,0.5)] hover:-translate-y-0.5 active:scale-[0.98] transition-all duration-300 flex justify-center items-center gap-3 group">
                    <span>Analyze Environment</span>
                    <svg class="group-hover:translate-x-1 transition-transform" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>
                </button>
            </div>

            <div id="loading-section" class="hidden text-center py-16 animate-enter">
                <div class="loading-spinner mx-auto mb-6"></div>
                <h3 class="font-serif text-xl mb-2">Syncing with Nature</h3>
                <p class="text-sm font-medium opacity-60">Consulting botanical models...</p>
            </div>

            <div id="results-section" class="hidden animate-enter">
                <div class="flex justify-between items-start mb-8 border-b border-seed-deep/10 pb-6">
                    <div>
                        <h2 class="font-serif text-3xl italic mb-1">Growth Forecast</h2>
                        <p id="seed-name-display" class="text-xs uppercase tracking-wider opacity-50 font-bold">Your Seed</p>
                    </div>
                    <button onclick="resetApp()" class="px-4 py-2 rounded-full text-[10px] font-bold bg-seed-sage/20 hover:bg-seed-sage/30 transition-colors uppercase tracking-widest opacity-70 hover:opacity-100">Reset</button>
                </div>

                <div class="grid grid-cols-2 gap-5 mb-8">
                    <div class="bg-white/60 p-5 rounded-[1.5rem] text-center shadow-sm">
                        <p class="text-[0.65rem] uppercase tracking-widest opacity-60 mb-2 font-bold">Success Rate</p>
                        <p id="success-val" class="text-4xl font-serif font-bold text-seed-deep">-</p>
                    </div>
                    <div class="bg-white/60 p-5 rounded-[1.5rem] text-center shadow-sm">
                        <p class="text-[0.65rem] uppercase tracking-widest opacity-60 mb-2 font-bold">Est. CO‚ÇÇ Offset</p>
                        <p id="co2-val" class="text-4xl font-serif font-bold text-seed-deep">-</p>
                    </div>
                </div>

                <div class="flex gap-4 mb-8 text-sm font-medium">
                    <div class="flex-1 flex items-center justify-center gap-3 p-4 bg-seed-sage/15 rounded-2xl border border-seed-sage/10">
                        <svg class="opacity-60" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/><path d="M10 10h4"/></svg>
                        <span id="temp-display">--¬∞C</span>
                    </div>
                    <div class="flex-1 flex items-center justify-center gap-3 p-4 bg-seed-sage/15 rounded-2xl border border-seed-sage/10">
                         <svg class="opacity-60" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z"/></svg>
                        <span id="hum-display">--%</span>
                    </div>
                </div>

                <div class="bg-seed-deep text-seed-cream p-6 rounded-[1.5rem] relative overflow-hidden shadow-lg">
                    <svg class="absolute top-0 right-0 opacity-10 pointer-events-none" width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke-width="0.5"/><path d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z" stroke-width="0.5"/></svg>
                    
                    <div class="relative z-10">
                        <p class="text-[0.65rem] font-bold uppercase opacity-60 mb-3 tracking-widest flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 12 2 2 4-4"/><path d="M5 7c0-1.1.9-2 2-2h10a2 2 0 0 1 2 2v12H5V7Z"/><path d="M22 19H2"/></svg>
                            Smart Suggestion
                        </p>
                        <p id="suggestion-text" class="text-lg font-serif leading-relaxed italic opacity-95">
                            "Loading..."
                        </p>
                    </div>
                </div>
            </div>

        </div>

        <footer class="text-center mt-8 pb-4">
            <p class="text-[10px] font-bold opacity-30 uppercase tracking-[0.2em]">Powered by OpenWeatherMap API</p>
        </footer>

    </main>

    <script>
        const API_KEY = 'dd28e0955cca98eeb8821425adb62c60'; 
        const CITY = 'Manipal,IN';

        // --- ENHANCED BOTANICAL DATABASE ---
        // carbonFactor: grams CO2 per year approx
        const seedKnowledge = {
            tomato: { 
                name: "Heirloom Tomato",
                optTemp: [20, 29], optHum: 65, carbonFactor: 210,
                tips: {
                    hot: "Tomatoes stop setting fruit above 30¬∞C. Move to afternoon shade.",
                    humid: "High humidity causes blight. Prune lower leaves for airflow."
                }
            },
            chilli: { 
                name: "Hot Chilli",
                optTemp: [25, 35], optHum: 60, carbonFactor: 180,
                tips: {
                    hot: "Chillies love this heat! Keep soil moist but not soggy.",
                    humid: "Excellent conditions. Peppers thrive in this humidity."
                }
            },
            marigold: { 
                name: "French Marigold",
                optTemp: [18, 30], optHum: 50, carbonFactor: 120,
                tips: {
                    hot: "Marigolds are hardy, but 30¬∞C+ stresses blooms. Water daily.",
                    humid: "Watch for mildew on leaves. Avoid overhead watering."
                }
            },
            coriander: { 
                name: "Coriander",
                optTemp: [15, 25], optHum: 40, carbonFactor: 80,
                tips: {
                    hot: "It is too hot! Coriander will 'bolt' (flower) instantly. Plant indoors.",
                    humid: "Too humid. The delicate stems may rot. Use very sandy soil."
                }
            },
            basil: { 
                name: "Genovese Basil",
                optTemp: [22, 32], optHum: 65, carbonFactor: 150,
                tips: {
                    hot: "Basil loves warmth, but harvest often to prevent flowering.",
                    humid: "Good humidity for leaf growth. Keep harvesting!"
                }
            },
            spinach: { 
                name: "Spinach",
                optTemp: [10, 24], optHum: 50, carbonFactor: 90,
                tips: {
                    hot: "Critical Heat Alert! Spinach fails above 26¬∞C. Use 100% shade.",
                    humid: "Leaves may yellow in this dampness. Ensure pot drains fast."
                }
            }
        };

        async function calculateImpact() {
            document.getElementById('input-section').classList.add('hidden');
            document.getElementById('loading-section').classList.remove('hidden');

            const seedType = document.getElementById('seedSelect').value;
            const seed = seedKnowledge[seedType];
            document.getElementById('seed-name-display').innerText = seed.name;

            try {
                const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${CITY}&units=metric&appid=${API_KEY}`);
                if (!response.ok) throw new Error(response.status);
                const data = await response.json();
                
                const temp = data.main.temp;
                const hum = data.main.humidity;
                
                // --- ADVANCED HEURISTIC ENGINE ---
                let probability = 98; 
                let suggestion = "";

                // 1. Temperature Calculation
                if (temp < seed.optTemp[0]) {
                    // Too Cold
                    probability -= Math.pow(seed.optTemp[0] - temp, 1.5);
                    suggestion = "It's a bit chilly for this variety. Use a greenhouse cover.";
                } else if (temp > seed.optTemp[1]) {
                    // Too Hot
                    probability -= Math.pow(temp - seed.optTemp[1], 1.5);
                    suggestion = seed.tips.hot;
                }

                // 2. Humidity Calculation
                if (Math.abs(hum - seed.optHum) > 15) {
                    probability -= (Math.abs(hum - seed.optHum) / 3);
                    // Only overwrite temp suggestion if humidity issue is severe
                    if (hum > 80) suggestion = seed.tips.humid; 
                }

                // 3. Perfect Condition Override
                if (temp >= seed.optTemp[0] && temp <= seed.optTemp[1] && Math.abs(hum - seed.optHum) < 15) {
                    suggestion = `Perfect conditions! Your ${seed.name} will germinate rapidly in this weather.`;
                }

                // 4. Critical Failure Override (e.g. Spinach in 35C)
                if (probability < 40) {
                    suggestion = `Current weather is harsh for ${seed.name}. ${suggestion}`;
                }

                // Clamp & Calculate
                probability = Math.min(Math.max(probability, 10), 99);
                const co2Total = (seed.carbonFactor * 365 * (probability / 100)).toFixed(1);

                setTimeout(() => {
                    renderResults(probability, co2Total, temp, hum, suggestion);
                }, 1200);

            } catch (error) {
                console.error(error);
                setTimeout(() => { renderResults(88, 210, 29, 78, "Simulated: Weather API unavailable."); }, 1500);
            }
        }

        function renderResults(prob, co2, temp, hum, suggestion) {
            document.getElementById('loading-section').classList.add('hidden');
            document.getElementById('results-section').classList.remove('hidden');
            
            document.getElementById('temp-display').innerText = `${Math.round(temp)}¬∞C`;
            document.getElementById('hum-display').innerText = `${hum}%`;
            document.getElementById('suggestion-text').innerText = `"${suggestion}"`;
            
            animateValue("success-val", 0, Math.round(prob), 1200, "%");
            animateValue("co2-val", 0, co2, 1500, "g");
        }

        function animateValue(id, start, end, duration, suffix) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                let currentVal = Math.floor(easeOutQuart * (end - start) + start);
                obj.innerHTML = currentVal + suffix;
                if (progress < 1) window.requestAnimationFrame(step);
                else obj.innerHTML = end + suffix;
            };
            window.requestAnimationFrame(step);
        }

        function resetApp() {
            document.getElementById('results-section').classList.add('hidden');
            document.getElementById('input-section').classList.remove('hidden');
        }
    </script>
</body>
</html>
