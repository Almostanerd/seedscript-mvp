<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SeedScript | Phygital Impact Lab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        seed: { cream: '#FDFBF7', sage: '#C3D0C1', deep: '#4A5D4E', accent: '#D4A373' }
                    },
                    fontFamily: { sans: ['Outfit', 'sans-serif'], serif: ['Playfair Display', 'serif'] },
                    animation: {
                        'enter': 'fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards',
                        'float-slow': 'float 15s ease-in-out infinite',
                    },
                    keyframes: {
                        fadeInUp: { '0%': { opacity: '0', transform: 'translateY(30px) scale(0.98)' }, '100%': { opacity: '1', transform: 'translateY(0) scale(1)' } },
                        float: { '0%, 100%': { transform: 'translate(0, 0) rotate(0deg)' }, '50%': { transform: 'translate(30px, -20px) rotate(8deg)' } }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #FDFBF7; color: #4A5D4E; overflow-x: hidden; }
        .glass-panel { background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.9); box-shadow: 0 20px 40px -10px rgba(74, 93, 78, 0.1); }
        .loading-spinner { border: 3px solid rgba(74, 93, 78, 0.1); border-left-color: #4A5D4E; border-radius: 50%; width: 30px; height: 30px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        select {-webkit-appearance: none; appearance: none;}
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center py-10 px-4 relative antialiased" onload="initLocation()">

    <div class="fixed inset-0 pointer-events-none -z-10 overflow-hidden">
        <div class="absolute top-0 left-0 -translate-x-1/4 -translate-y-1/4 w-96 h-96 bg-seed-sage/30 rounded-full blur-3xl animate-float-slow"></div>
        <div class="absolute bottom-0 right-0 translate-x-1/4 translate-y-1/4 w-[35rem] h-[35rem] bg-seed-accent/15 rounded-full blur-3xl animate-float-slow" style="animation-delay: -5s;"></div>
    </div>

    <main class="w-full max-w-md relative z-10 opacity-0 animate-enter">
        <header class="text-center mb-6">
            <div class="inline-flex p-4 rounded-full bg-white/80 mb-4 shadow-sm ring-1 ring-seed-sage/20">
               <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#4A5D4E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22v-5"/><path d="M9 12.22c.82-.7 2.3-1.66 3-2.22 0 0 2.29 1.75 3.8 3.44 1.3 1.45 2.2 3.86 1.48 5.35C16.4 20.5 14 22 12 22s-4.4-1.5-5.28-3.21c-.72-1.49.18-3.9 1.48-5.35z"/><path d="M12 10c.38-.6 1.27-1.92 2-3.41 1.22-2.5 1.46-4.89.73-5.87-.81-1.1-3.28-.44-5.46 1.75C8.07 3.53 7.5 4.8 7.5 6c0 2.06.79 4.19 2 6"/></svg>
            </div>
            <h1 class="font-serif text-5xl italic font-medium mb-2 text-seed-deep tracking-tight">SeedScript</h1>
            <p class="text-[0.65rem] font-bold tracking-[0.3em] uppercase text-seed-deep/60">Sustainability Boutique</p>
        </header>

        <div class="glass-panel rounded-[2rem] p-8 sm:p-10 transition-all duration-500 relative overflow-hidden">
            
            <div id="input-section">
                <label class="block text-sm font-medium mb-3 ml-1 tracking-wide uppercase text-xs opacity-70">Select Pencil Variety</label>
                <div class="relative mb-8 group">
                    <select id="seedSelect" class="w-full p-5 pr-12 rounded-2xl bg-white/90 border-2 border-transparent text-seed-deep font-serif text-xl focus:border-seed-sage/50 outline-none cursor-pointer shadow-sm font-sans">
                        <option value="tomato">üçÖ Heirloom Tomato</option>
                        <option value="chilli">üå∂Ô∏è Hot Chilli</option>
                        <option value="marigold">üåº French Marigold</option>
                        <option value="coriander">üåø Coriander (Dhania)</option>
                        <option value="basil">üçÉ Genovese Basil</option>
                        <option value="spinach">ü•¨ Spinach (Palak)</option>
                    </select>
                </div>

                <div class="flex items-center gap-4 mb-10 p-5 bg-seed-sage/15 rounded-2xl border border-seed-sage/10">
                    <div class="p-2.5 bg-white rounded-full shadow-sm">üìç</div>
                    <div class="text-sm leading-tight">
                        <p class="font-bold opacity-80 mb-0.5">Garden Climate</p>
                        <p id="location-name-ui" class="opacity-60 font-medium italic">Detecting garden...</p>
                    </div>
                </div>

                <button onclick="calculateImpact()" class="w-full py-5 rounded-full bg-seed-deep text-seed-cream font-bold text-lg shadow-lg active:scale-[0.98] transition-all">
                    Analyze My Garden
                </button>
            </div>

            <div id="loading-section" class="hidden text-center py-16 animate-enter">
                <div class="loading-spinner mx-auto mb-6"></div>
                <h3 class="font-serif text-xl mb-2">Consulting the Earth...</h3>
                <p class="text-sm font-medium opacity-60">Syncing with atmospheric sensors.</p>
            </div>

            <div id="results-section" class="hidden animate-enter">
                <div class="flex justify-between items-start mb-8 border-b border-seed-deep/10 pb-6">
                    <div>
                        <h2 class="font-serif text-3xl italic mb-1">Impact Forecast</h2>
                        <p id="seed-name-display" class="text-xs uppercase font-bold opacity-50">Variety</p>
                    </div>
                    <button onclick="resetApp()" class="px-4 py-2 rounded-full text-[10px] font-bold bg-seed-sage/20 uppercase opacity-70">Back</button>
                </div>

                <div class="grid grid-cols-2 gap-5 mb-6">
                    <div class="bg-white/60 p-5 rounded-[1.5rem] text-center shadow-sm">
                        <p class="text-[0.65rem] uppercase font-bold opacity-40 mb-1">Survival Odds</p>
                        <p id="success-val" class="text-4xl font-serif font-bold text-seed-deep">-</p>
                    </div>
                    <div class="bg-white/60 p-5 rounded-[1.5rem] text-center shadow-sm">
                        <p class="text-[0.65rem] uppercase font-bold opacity-40 mb-1">CO‚ÇÇ Captured</p>
                        <p id="co2-val" class="text-4xl font-serif font-bold text-seed-deep">-</p>
                    </div>
                </div>

                <div id="mismatch-box" class="p-5 bg-seed-sage/10 rounded-3xl mb-6 space-y-3">
                    <div class="flex justify-between text-xs font-bold uppercase opacity-60 tracking-wider">
                        <span>Nature Scan</span>
                        <span>Reading</span>
                    </div>
                    <div class="flex justify-between text-sm font-medium border-t border-seed-deep/5 pt-2">
                        <span>üå°Ô∏è Temperature</span>
                        <span id="temp-display">--</span>
                    </div>
                    <div class="flex justify-between text-sm font-medium">
                        <span>üíß Humidity</span>
                        <span id="hum-display">--</span>
                    </div>
                    <p id="data-deep-dive" class="text-[10px] font-medium leading-relaxed italic opacity-80 pt-2 border-t border-seed-deep/5"></p>
                </div>

                <div class="bg-seed-deep text-seed-cream p-6 rounded-[1.5rem] shadow-lg">
                    <p class="text-[0.65rem] font-bold uppercase opacity-60 mb-3 tracking-widest">Secret Growth Strategy</p>
                    <p id="suggestion-text" class="text-lg font-serif leading-relaxed italic opacity-95">"Thinking..."</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        const API_KEY = 'a762377e064d6c67247dd4b7e9e5c21c'; 
        let globalWeatherData = null;
        let detectedCity = "Manipal";

        const seedKnowledge = {
            tomato: { name: "Heirloom Tomato", opt: [20, 29, 65], co2: 210, 
                quirks: { 
                    cold: "It's a bit chilly in CITY_NAME right now! Mission: Keep this pencil-pot indoors near a warm window. It loves that cozy study-desk heat while it sprouts.",
                    hot: "CITY_NAME is officially a furnace today! Mission: Move your Tomato to an indoor shelf or deep shade. Divas like this need a cool break from the peak sun.",
                    humid: "Tropical spa vibes in CITY_NAME! Your Tomato is ready for the moisture‚Äîjust give it a little indoor breeze to keep it feeling fresh and fungi-free."
                }
            },
            chilli: { name: "Hot Chilli", opt: [25, 35, 60], co2: 180,
                quirks: {
                    cold: "CITY_NAME is in Hibernation Mode! Chillies are tropical souls. Start this one in a cozy indoor corner where it's toastier. It'll explode into life when summer hits.",
                    hot: "Spicy Summer Mission! The CITY_NAME heat is perfect for developing that famous chilli kick. Just keep the soil moist like a swamp and watch it thrive.",
                    humid: "Jungle Fever in CITY_NAME! Chillies love this humid air; they're practically on vacation. Perfect time to plant and watch them take over your balcony."
                }
            },
            marigold: { name: "French Marigold", opt: [18, 30, 50], co2: 120,
                quirks: {
                    cold: "Frost-Proofing Strategy for CITY_NAME! A little chill won't stop a Marigold. Keep it indoors at night like a roommate, and let it sunbathe during the day.",
                    hot: "Golden Hour in CITY_NAME! Marigolds love the light. Give them a heavy long drink at dawn and they'll be the floral bodyguards of your garden all day.",
                    humid: "Lush Vibes! The CITY_NAME humidity makes them extra leafy. Keep the water at the soil level (not the leaves!) to keep them looking fresh and bold."
                }
            },
            coriander: { name: "Coriander", opt: [15, 25, 40], co2: 80,
                quirks: {
                    cold: "Winter Wonderland! CITY_NAME is coriander heaven right now. This crisp air means extra flavor. Best time to plant for that perfect Dhania garnish.",
                    hot: "Kitchen Garden Mission! It's too hot on your CITY_NAME balcony. Grow this one right on your cool indoor desk to keep it from flowering too early.",
                    humid: "Fresh Air Fan! Coriander likes it breezy in CITY_NAME. Use a well-drained pot and keep it near an open window to enjoy the humidity without the rot."
                }
            },
            basil: { name: "Genovese Basil", opt: [22, 32, 65], co2: 150,
                quirks: {
                    cold: "Indoor Royalty! Basil turns black in the CITY_NAME cold. It‚Äôs officially an indoor herb for now. Keep it near your laptop‚Äîthe warmth helps it sprout!",
                    hot: "Summer Pesto Party! Basil is living its best life in this CITY_NAME sun. Keep picking the top leaves for your pasta and it will grow bushier every day.",
                    humid: "Spa Day! CITY_NAME humidity means huge, delicious leaves. This is peak basil weather‚Äîplant now for an incredible scent in your entire room."
                }
            },
            spinach: { name: "Spinach", opt: [10, 24, 50], co2: 90,
                quirks: {
                    cold: "Penguin Mode! Spinach is the ultimate cold-weather hero. It loves this CITY_NAME chill more than you do. Expect rapid, crunchy growth outside.",
                    hot: "Microgreen Challenge! Too hot for big leaves in CITY_NAME? Grow your spinach as indoor 'micro-greens' for your noodles. Fast, healthy, and cool.",
                    humid: "Lush Vibes! Spinach loves the CITY_NAME dampness. Just ensure your pot has great drainage so the roots don't get 'soggy feet' while growing."
                }
            }
        };

        async function initLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async (pos) => {
                    const { latitude, longitude } = pos.coords;
                    const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&units=metric&appid=${API_KEY}`);
                    globalWeatherData = await res.json();
                    detectedCity = globalWeatherData.name;
                    document.getElementById('location-name-ui').innerText = `${detectedCity}, ${globalWeatherData.sys.country}`;
                }, () => {
                    document.getElementById('location-name-ui').innerText = "Manipal, Karnataka (IN)";
                });
            }
        }

        async function calculateImpact() {
            document.getElementById('input-section').classList.add('hidden');
            document.getElementById('loading-section').classList.remove('hidden');

            const seed = seedKnowledge[document.getElementById('seedSelect').value];
            document.getElementById('seed-name-display').innerText = seed.name;

            if (!globalWeatherData) {
                const res = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=Manipal,IN&units=metric&appid=${API_KEY}`);
                globalWeatherData = await res.json();
            }

            processFinalLogic(globalWeatherData, seed);
        }

        function processFinalLogic(data, seed) {
            const temp = data.main.temp;
            const hum = data.main.humidity;
            let prob = 94; 
            let suggestion = "";
            let deepDive = `Environmental Sync: `;

            if (temp < seed.opt[0]) {
                const delta = (seed.opt[0] - temp).toFixed(1);
                prob -= (delta * 0.8);
                suggestion = seed.quirks.cold.replace(/CITY_NAME/g, detectedCity);
                deepDive += `It's crisp out! An indoor start is your secret weapon. `;
            } else if (temp > seed.opt[1]) {
                const delta = (temp - seed.opt[1]).toFixed(1);
                prob -= (delta * 1.0);
                suggestion = seed.quirks.hot.replace(/CITY_NAME/g, detectedCity);
                deepDive += `Sun alert! Shady spots or indoor shelves work best today. `;
            } else {
                suggestion = `Perfect conditions in ${detectedCity}! Your ${seed.name} is ready for an outdoor adventure.`;
                deepDive += `Climate is in the Goldilocks zone. `;
            }

            if (Math.abs(hum - seed.opt[2]) > 20 && hum > 80) {
                suggestion = seed.quirks.humid.replace(/CITY_NAME/g, detectedCity);
            }

            prob = Math.min(Math.max(prob, 72), 99);
            const co2 = (seed.co2 * (prob / 100) * 1.8).toFixed(0);

            setTimeout(() => {
                document.getElementById('loading-section').classList.add('hidden');
                document.getElementById('results-section').classList.remove('hidden');
                document.getElementById('temp-display').innerText = `${Math.round(temp)}¬∞C`;
                document.getElementById('hum-display').innerText = `${hum}%`;
                document.getElementById('data-deep-dive').innerText = deepDive;
                document.getElementById('suggestion-text').innerText = `"${suggestion}"`;
                animateValue("success-val", 0, Math.round(prob), 1200, "%");
                animateValue("co2-val", 0, co2, 1500, "g");
            }, 1200);
        }

        function animateValue(id, start, end, duration, suffix) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                obj.innerHTML = Math.floor(easeOutQuart * (end - start) + start) + suffix;
                if (progress < 1) window.requestAnimationFrame(step);
                else obj.innerHTML = end + suffix;
            };
            window.requestAnimationFrame(step);
        }

        function resetApp() {
            document.getElementById('results-section').classList.add('hidden');
            document.getElementById('input-section').classList.remove('hidden');
        }
    </script>
</body>
</html>
